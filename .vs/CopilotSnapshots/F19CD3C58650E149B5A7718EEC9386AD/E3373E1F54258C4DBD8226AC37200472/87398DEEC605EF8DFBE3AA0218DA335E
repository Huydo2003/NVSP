/**
 * Navigation.jsx - Menu điều hướng
 * 
 * Chức năng:
 * - Hiển thị menu theo vai trò
 * - Quản lý chuyển trang
 * - Hiển thị thông tin người dùng
 * - Xử lý đăng xuất
 */

import { useApp } from '../hooks/useApp';

export default function Navigation({ activeTab, setActiveTab, user, onLogout }) {
  const { state } = useApp();
  const { config } = state;

  const getMenuItems = () => {
    const baseItems = [
      { id: 'dashboard', label: 'Tổng quan' },
      { id: 'account', label: 'Tài khoản' }
    ];

    switch (user.role) {
      case 'admin':
        return [
          ...baseItems,
          { id: 'events', label: 'Quản lý sự kiện' },
          { id: 'competitions', label: 'Hoạt động dự thi' },
          { id: 'support', label: 'Hoạt động hỗ trợ' },
          { id: 'attendance', label: 'Hoạt động tham dự' },
          { id: 'notifications', label: 'Thông báo' },
          { id: 'results', label: 'Kết quả' },
          { id: 'certificates', label: 'Chứng nhận' },
          { id: 'reports', label: 'Báo cáo' },
          { id: 'users', label: 'Quản lý người dùng' },
          { id: 'voting', label: 'Bình chọn' },
          // New type management entries
          { id: 'account_types', label: 'Loại tài khoản' },
          { id: 'event_types', label: 'Loại sự kiện' },
          { id: 'certificate_types', label: 'Loại chứng nhận' },
          { id: 'support_types', label: 'Loại hỗ trợ' },
          { id: 'organizers', label: 'Ban tổ chức' },
          { id: 'organizer_levels', label: 'Cấp ban tổ chức' }
        ];
      case 'btc':
        return [
          ...baseItems,
          { id: 'events', label: 'Quản lý sự kiện' },
          { id: 'competitions', label: 'Hoạt động dự thi' },
          { id: 'registrations', label: 'Đăng ký & Xét duyệt' },
          { id: 'attendance', label: 'Điểm danh' },
          { id: 'results', label: 'Nhập kết quả' },
          { id: 'certificates', label: 'Cấp chứng nhận' }
        ];
      case 'cbl':
        return [
          ...baseItems,
          { id: 'registrations', label: 'Đăng ký sinh viên' },
          { id: 'attendance', label: 'Điểm danh' },
          { id: 'notifications', label: 'Thông báo' }
        ];
      case 'student':
        return [
          ...baseItems,
          { id: 'register', label: 'Đăng ký tham gia' },
          { id: 'schedule', label: 'Lịch thi' },
          { id: 'attendance', label: 'Điểm danh' },
          { id: 'certificates', label: 'Chứng nhận của tôi' }
        ];
      case 'judge':
        return [
          ...baseItems,
          { id: 'judging', label: 'Chấm thi' },
          { id: 'schedule', label: 'Lịch chấm thi' }
        ];
      default:
        return baseItems;
    }
  };

  return (
    <nav className="gradient-bg text-white w-64 min-h-full p-4 slide-in">
      <div className="mb-8">
        <h1 className="text-xl font-bold mb-2">{config.system_title}</h1>
        <div className="text-sm opacity-90">
          <p>{user.username || user.name || 'Người dùng'}</p>
          <p className="text-xs">{user.email}</p>
        </div>
      </div>
      
      <ul className="space-y-2">
        {getMenuItems().map(item => (
          <li key={item.id}>
            <button
              onClick={() => setActiveTab(item.id)}
              className={`nav-item w-full text-left px-3 py-2 ${
                activeTab === item.id ? 'active' : ''
              }`}
            >
              <span>{item.label}</span>
            </button>
          </li>
        ))}
      </ul>
      
      <div className="mt-8 pt-4 border-t border-white/20">
        <button
          onClick={onLogout}
          className="nav-item w-full text-left px-3 py-2 text-red-200 hover:text-white"
        >
          <span>Đăng xuất</span>
        </button>
      </div>
    </nav>
  );
}